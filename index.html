<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUKUNA MASTER - V6.0 CONTROL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Cairo:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f3ff; --magenta: #ff00ff; --dark: #050505; }
        body { margin: 0; background: var(--dark); color: white; font-family: 'Cairo', sans-serif; overflow: hidden; }
        #particles-js { position: absolute; width: 100%; height: 100%; z-index: 1; }
        .hero { position: relative; z-index: 2; height: 100vh; display: flex; align-items: center; justify-content: center; }
        .app-card { background: rgba(255, 255, 255, 0.02); padding: 30px; border-radius: 25px; border: 1px solid rgba(0, 243, 255, 0.2); backdrop-filter: blur(15px); width: 85%; max-width: 380px; text-align: center; }
        .logo { width: 100px; height: 100px; border-radius: 50%; border: 2px solid var(--neon); box-shadow: 0 0 15px var(--neon); cursor: pointer; }
        h1 { font-family: 'Orbitron', sans-serif; color: var(--neon); text-shadow: 0 0 10px var(--neon); }
        .g-btn { width: 100%; background: linear-gradient(45deg, #111, #1a1a1a); border: 1px solid var(--neon); color: white; padding: 15px; border-radius: 10px; font-weight: 900; cursor: pointer; margin-top: 15px; }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ (Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„) */
        #regModal { display: none; position: fixed; z-index: 200; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #111; border: 2px solid var(--neon); border-radius: 20px; padding: 20px; box-shadow: 0 0 30px var(--neon); }
        .input-group { margin-bottom: 15px; text-align: right; }
        .input-group label { display: block; margin-bottom: 5px; color: var(--neon); font-size: 0.8rem; }
        .input-group input, .input-group select { width: 100%; padding: 10px; background: #222; border: 1px solid #444; color: white; border-radius: 8px; box-sizing: border-box; }
        .phone-input { display: flex; gap: 5px; }
        .phone-input select { width: 40%; }
        .phone-input input { width: 60%; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† */
        #adminPanel { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 100; display: none; padding: 15px; overflow-y: auto; }
        .player-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; margin-top: 10px; }
        .player-table th { background: var(--neon); color: #000; padding: 8px; }
        .player-table td { padding: 8px; border-bottom: 1px solid #333; text-align: center; }
        .whatsapp-link { color: #25D366; text-decoration: none; font-weight: bold; }
        .admin-btn { padding: 10px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; width: 100%; }
    </style>
</head>
<body>

<div id="particles-js"></div>

<div class="hero">
    <div class="app-card">
        <img src="abc.jpg" class="logo" onclick="checkAdmin()">
        <h1>SUKUNA MASTER</h1>
        <button class="g-btn" id="btn_reg" onclick="openModal()">ğŸ† ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©</button>
    </div>
</div>

<div id="regModal">
    <h3 style="color:var(--neon); text-align:center; margin-top:0;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚</h3>
    <div class="input-group">
        <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ:</label>
        <input type="text" id="regName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
    </div>
    <div class="input-group">
        <label>Ø§Ù„Ù€ ID ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©:</label>
        <input type="number" id="regID" placeholder="12345678">
    </div>
    <div class="input-group">
        <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</label>
        <div class="phone-input">
            <select id="countryCode">
                <option value="20">ğŸ‡ªğŸ‡¬ +20</option>
                <option value="966">ğŸ‡¸ğŸ‡¦ +966</option>
                <option value="212">ğŸ‡²ğŸ‡¦ +212</option>
                <option value="213">ğŸ‡©ğŸ‡¿ +213</option>
                <option value="216">ğŸ‡¹ğŸ‡³ +216</option>
                <option value="964">ğŸ‡®ğŸ‡¶ +964</option>
                <option value="962">ğŸ‡¯ğŸ‡´ +962</option>
            </select>
            <input type="number" id="regPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„">
        </div>
    </div>
    <button class="g-btn" onclick="submitRegistration()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ âœ…</button>
    <button onclick="closeModal()" style="width:100%; background:none; border:none; color:#666; margin-top:10px; cursor:pointer;">Ø¥Ù„ØºØ§Ø¡</button>
</div>

<div id="adminPanel">
    <div style="display:flex; justify-content:space-between; border-bottom:2px solid var(--neon); padding-bottom:10px;">
        <h2 style="color:var(--neon); margin:0;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
        <button onclick="closeAdmin()" style="color:red; background:none; border:1px solid red; padding:5px 15px; border-radius:5px;">X</button>
    </div>

    <div style="background: #111; padding: 15px; border-radius: 10px; margin-top: 15px;">
        <h4 style="margin:0 0 10px 0; color:var(--magenta);">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:</h4>
        <button class="admin-btn" style="background:var(--magenta); color:white;" onclick="resetGlobalRegistration()">ğŸ”„ ØªØµÙÙŠØ± Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹)</button>
        <button class="admin-btn" style="background:#444; color:white; margin-top:10px;" onclick="clearAll()">âš ï¸ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    </div>

    <h3 style="margin-top: 20px;">Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚ÙŠÙ† (<span id="count">0</span>)</h3>
    <table class="player-table">
        <thead>
            <tr>
                <th>Ø§Ù„Ø§Ø³Ù…</th>
                <th>ID</th>
                <th>ÙˆØ§ØªØ³Ø§Ø¨</th>
                <th>Ø­Ø°Ù</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, set, get, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = { databaseURL: "https://project-fe025bb5-b1cc-4b8f-93e-default-rtdb.firebaseio.com" };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Ù…ØªØ§Ø¨Ø¹Ø© Ù†Ø³Ø®Ø© Ø§Ù„Ø±ÙŠØ³ÙŠØª Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
    onValue(ref(db, 'settings/reset_version'), (snap) => {
        const serverVersion = snap.val() || 0;
        const localVersion = localStorage.getItem('reset_version') || 0;
        
        // Ù„Ùˆ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¹Ù†Ø¯Ù‡ Ù†Ø³Ø®Ø© Ø±ÙŠØ³ÙŠØª Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø§Ù…Ø³Ø­ Ø§Ù„Ù‚ÙÙ„ Ø§Ù„Ù…Ø­Ù„ÙŠ
        if (serverVersion > localVersion) {
            localStorage.removeItem('registered');
            localStorage.setItem('reset_version', serverVersion);
        }
    });

    window.openModal = () => {
        if (localStorage.getItem('registered')) return alert("Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©!");
        document.getElementById('regModal').style.display = 'block';
    };
    window.closeModal = () => document.getElementById('regModal').style.display = 'none';

    window.submitRegistration = async () => {
        const name = document.getElementById('regName').value;
        const id = document.getElementById('regID').value;
        const code = document.getElementById('countryCode').value;
        const phone = document.getElementById('regPhone').value;

        if(!name || !id || !phone) return alert("Ø¨Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¦ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø§Ù†Ø§Øª!");

        const snap = await get(ref(db, 'players'));
        let dup = false;
        if(snap.exists()) snap.forEach(c => { if(c.val().id === id) dup = true; });
        if(dup) return alert("Ù‡Ø°Ø§ Ø§Ù„Ù€ ID Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„!");

        push(ref(db, 'players'), { name, id, phone: code + phone })
        .then(() => {
            localStorage.setItem('registered', 'true');
            alert("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
            closeModal();
        });
    };

    // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø±ÙŠØ³ÙŠØª Ù„Ù„Ø£Ø¯Ù…Ù†
    window.resetGlobalRegistration = async () => {
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚ÙŠÙ† Ø¨Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŸ (Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ù‚ÙÙ„ 'Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª Ù…Ø³Ø¨Ù‚Ø§Ù‹' Ù…Ù† Ù‡ÙˆØ§ØªÙÙ‡Ù…)")) {
            const resetRef = ref(db, 'settings/reset_version');
            const snap = await get(resetRef);
            const currentVersion = snap.val() || 0;
            // Ù†Ø±ÙØ¹ Ø±Ù‚Ù… Ø§Ù„Ù†Ø³Ø®Ø© Ø¹Ø´Ø§Ù† Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ØªØ¹Ø±Ù Ø¥Ù† ÙÙŠ Ø±ÙŠØ³ÙŠØª Ø­ØµÙ„
            set(resetRef, currentVersion + 1).then(() => {
                alert("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ† Ù„Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹.");
            });
        }
    };

    // Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
    onValue(ref(db, 'players'), (snapshot) => {
        const tbody = document.getElementById('tableBody');
        const countSpan = document.getElementById('count');
        tbody.innerHTML = ""; let count = 0;
        if (snapshot.exists()) {
            snapshot.forEach((child) => {
                count++; const p = child.val();
                tbody.innerHTML += `<tr>
                    <td>${p.name}</td>
                    <td>${p.id}</td>
                    <td><a class="whatsapp-link" href="https://wa.me/${p.phone}" target="_blank">ÙˆØ§ØªØ³Ø§Ø¨</a></td>
                    <td><button onclick="deletePlayer('${child.key}')" style="background:red; color:white; border:none; border-radius:3px; padding:2px 8px;">X</button></td>
                </tr>`;
            });
            countSpan.innerText = count;
        }
    });

    window.deletePlayer = (key) => { if(confirm("Ø­Ø°ÙØŸ")) remove(ref(db, 'players/'+key)); };
    window.clearAll = () => { if(confirm("Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ØŸ")) remove(ref(db, 'players')); };
    
    let clicks = 0;
    window.checkAdmin = () => {
        clicks++;
        if(clicks >= 5) {
            if(prompt("Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯:") === "cheats777") document.getElementById('adminPanel').style.display = 'block';
            clicks = 0;
        }
    };
    window.closeAdmin = () => document.getElementById('adminPanel').style.display = 'none';

    particlesJS('particles-js', { "particles": { "number": { "value": 40 }, "color": { "value": "#00f3ff" }, "line_linked": { "enable": true, "color": "#00f3ff" }, "move": { "speed": 2 } } });
</script>
</body>
</html>
